一、应用场景

    1、一个局域网内接入多台计算机，每台计算机各自运行一套功能相同的操作界面。每个操作界面对应一个peer。
    2、一个局域网内，只能有一个peer获得控制权，即令牌（token）。获得令牌的peer可以对底层设备进行操作和控制。
    3、每个peer能感知局域网内所有peer，生成一个peer列表。其中包含每个peer的一些基本信息。该列表为交换令牌提供基本数据。
    4、每个peer可以互相交换令牌。交换过程包含：主动peer提交、被动peer应答两个步骤。主动peer可以发出获取令牌请求，也可以发出让出令牌请求。
    对应的，被动peer可以做出让出令牌应答以及获取令牌应答。简单示意图如下：

        主动peer             被动peer      角色
        提交                 应答          步骤

        主动获取------------->被动让出      =完成交换
        主动让出------------->被动获取      =完成交换
        --------------------------------->时间轴

        另外要考虑：主动peer取消、被动peer取消以及超时的特殊情况。

    5、保证peer运行状态产生变化时，如设备宕机、网络断线、与底层设备失去联系等，自动修改令牌状态，保证：
        a.一个网络内最多只有一个令牌，即网络内可以短时间没有令牌，但是不能有两个令牌。
        b.与底层设备失去联系的peer令牌消失，且不能再获得令牌。
        c.保证无扰动切换，获得令牌的主站会广播控制状态，未获得令牌的站会自动同步跟踪（由操作面板逻辑配合完成）
        d.每个peer预先分配一个优先级。优先级最高的站，在网络上无令牌(blackout)的情况下自动产生令牌。
    6、未来考虑：
        a.动态优先级策略。比如ecc、whc、mobile三个peer，且ecc拥有最高优先级（静态），whc把令牌切至mobile，而后mobile由于某种原因断线，
        此时ecc优先生成令牌。若采用某种动态优先级策略，可以使得whc优先生成令牌（因为whc是最后一个令牌拥有者）。
        b.会有事先组态好的peer列表，peer列表由动态获取以及静态组态两个部分组成。
        c.跨网段甚至在公网使用。要做一个Server在本地内网转发。

二、功能规划

    设计一个令牌管理器类，具备以下几种功能：
    1、监听UDP端口，获取以下几种类型消息
        a.其他peer的心跳报文，用来更新peer列表。
        b.其他peer对本peer的指令报文。
        c.指令处理部分可扩展。
    2、UDP广播发数
        a.本peer心跳报文
        b.本peer对其他peer的指令报文
        c.还可扩展其他报文
    3、交换令牌的API
        a.主动获取提交、主动获取取消
        b.主动让出提交、主动让出取消
        c.被动获取应答、被动获取取消
        d.被动让出应答、被动让出取消
        e.交换成功、交换取消、交换失败（超时）的通知和处理API
    4、peer列表维护
        a.更新数据
        b.超时掉线peer判断
        c.保存/读取xml
    5、异常处理
        a.令牌丢失重建
